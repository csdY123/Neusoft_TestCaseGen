{
  "export_time": "2025-12-03T00:39:50.107997",
  "document": {
    "id": "d515e436a0e142d6ac414c02ceea2bb7",
    "display_name": "PRD_海外导航地图_人机共驾.docx (d515e436)"
  },
  "prd_text": "PRD_海外导航地图_人机共驾\n产品需求文档\n人机共驾\n目录\n1概要4\n1.1使用Unity 3D描画4\n2名词定义4\n3功能4\n3.1人机共驾路段的内容显示4\n3.1.1在算路画页加入人机共驾功能的显示4\n3.2人机共驾模式的开启与退出显示5\n3.2.1人机共驾导航模式的开启5\n3.2.2人机共驾导航模式的退出6\n3.2.3用户主动结束人机共驾导航7\n3.3人机共驾的导航的显示内容8\n3.3.1车道级导航地图显示8\n3.3.2导航内车辆引导线的显示9\n3.3.3导航内ADAS识别物体的显示9\n3.3.4导航内人机共驾驾驶方向显示10\n3.3.5导航内人机共驾模式与标清导航的切换11\n3.4人机共驾导航的警示信息12\n3.4.1碰撞预警12\n3.4.2车道偏离12\n3.4.3强制驾驶员接管13\n4依赖13\n1. 概要\n人机共驾导航主要依托于ADAS系统，当ADAS系统启动并满足人机共驾模式启动条件时，车辆进入到人机共驾导航模式。导航需要对ADAS人机共驾模式，系统反馈或车机反馈的信息进行提示。\nADAS信息提示内容包含：ADAS识别的道路物体（包含车辆、行人等）的显示，ADAS变道、转向、汇入匝道等行为的提示，以及对碰撞预警、紧急刹车、车道偏离等信息的警示。\n1.1 使用Unity 3D描画\n人机共驾模式下，界面使用Unity 3D进行描画。\n2. 名词定义\n解释文档中使用的名词。\n3. 功能\n3.1 人机共驾路段的内容显示\n3.1.1 在算路画页加入人机共驾功能的显示\n当规划的路线中涵盖满足人机共驾路段的显示条件时，显示路段相关内容。其中包含规划路线内人机共驾模式可开启的距离，并在规划路线上以图标标注人机共驾路段的起始点。（参考图1）\n图1 在算路画页加入人机共驾功能的显示\n单经路情况下，显示内容相同，多路线的页面只显示一条路线：\n人机共驾路段的判断显示条件：\n从自动驾驶域获得可人机共驾区域的地理围栏，导航根据地理围栏判断可驾驶路段。\n3.2 人机共驾模式的开启与退出显示\n3.2.1 人机共驾导航模式的开启\n3.2.1.1 人机共驾导航模式的开启条件及状态\n从自动驾驶域获得进入人机共驾的时机。（需要与车机及ADAS确认）\n状态：\n非人机共驾路段：车辆位于人机共驾路段以外，不显示人机共驾信息窗口。\n人机共驾可开启：车辆位于人机共驾路段内，且用户未同意人机共驾的状态，显示人机共驾窗口，并提示“人机共驾可开启“\n人机共驾已开启：车辆位于人机共驾路段内，且用户已同意人机共驾的状态，显示人机共驾窗口，并提示“人机共驾已开启“\n3.2.1.2 人机共驾模式的开启\n当收到ADAS可开启人机共驾模式的信号（需要与ADAS及车机确认）,则弹出人机共驾状态信息窗口，显示人机共驾图标及文字“可开启人机共驾”\n当接收到ADAS开启信息时(用户同意开启后)，进入人机共驾导航模式，人机共驾窗口图标变成蓝色（参考UI设计），文字提示“已开启人机共驾”。\n如果未接收到开启信息(用户一直未同意)，并抵达人机共驾模式的终点或接收到ADAS无法开启人机共驾，则直接隐藏人机共驾信息窗口。\n3.2.2 人机共驾导航模式的退出\n车辆在处于人机共驾状态时，收到ADAS退出人机共驾模式的信号。退出共驾模式。\n退出方式包括如下几种，无论哪种方式退出，给用户的呈现是相同的。\n正常退出：当车辆行驶到可共驾路段终点，接收到ADAS退出人机共驾信号，则退出人机共驾模式。\n异常退出：当处于人机共驾模式时，接收到ADAS异常退出人机共驾信号，则退出人机共驾模式。如退出时仍处于人机共驾路段，则导航内人机共驾信息窗口由已开启状态转换为可开启状态。如已驶出人机共驾路段，导航内不再显示人机共驾信息窗口。\nOff Route退出：车辆偏移规划的路线时，导航接收到ADAS退出人机共驾信号，则退出人机共驾模式。\n用户手动退出：退出方式通常是用户操作方向盘的某个按钮，具体需要与车机和ADAS确认。用户手动退出时，导航接收到ADAS退出人机共驾信号，则退出人机共驾模式。如退出时仍处于人机共驾路段，导航内人机共驾信息窗口由已开启状态转换为可开启状态。如已驶出人机共驾路段，则不在显示人机共驾信息窗口。\n用户切换至标清地图状态下，遇到上述退出情况时（正常退出、Off Route退出、用户手动退出），保持在标清地图内，退出人机共驾模式。\n第1~4种退出具体呈现方式如下：\n接收ADAS退出人机共驾信号时，直接结束人机共驾窗口，如果此时地图仍在高精地图范围，则显示车道级导航；否则，显示标清地图。\n在导航的人机共驾信息窗口内显示文字：“已退出人机共驾模式”并闪烁灰色人机共驾图标。\n“灰色人机共驾图标闪烁3秒后，隐藏人机共驾状态信息窗口。\n第5种 退出具体呈现方式如下：\n接收ADAS退出人机共驾信号时，人机共驾状态信息窗口内的人机共驾图标由蓝色变为灰色;文字提示“已退出人机共驾模式”。\n灰色人机共驾图标3秒后，隐藏人机共驾状态信息窗口。\n保持在标清地图导航状态，继续引导。\n3.2.3 用户主动结束人机共驾导航\n当用户在人机共驾导航模式下，主动结束导航时，需要退出人机共驾模式。\n当用户点击结束导航按钮时：\n弹出POP弹窗：\n用户选择退出按钮时，退出人机共驾模式并停止本次导航（不显示退出动画，直接退出人机共驾模式，导航内也不显示动画）。返回至导航的首页面。\n用户选择取消时，隐去POP弹窗，保持在人机共驾状态下。\n3.3 人机共驾的导航的显示内容\n处于人机共驾模式状态下，导航界面显示ADAS提供的信息，其中包含人机共驾状态、ADAS识别物体，ADAS自动驾驶的方向控制。\n3.3.1 车道级导航地图显示\n车道级导航全屏显示，默认3D头上模式，并且不能更改。\n显示内容包括当前道路的道路面、路肩、车道线（实线、虚线、双黄线等）、车道的地面箭头、车辆所在的车道、建筑物、3D车标、导航引导信息。\n导航引导信息包括：左右转箭头、与前方引导点之间的距离、下一条道路名称、到目的地的残余距离、时间、车线信息、等引导信息。\n车道级导航显示时，不显示路口放大图，不能AutoZoom。\n不能操作地图（例如：不能滚动、拖拽、单击、双击、长压等），不能缩放比例尺，不能切换俯视角。\n3.3.1.1 人机共驾状态信息窗口的显示\n当收到ADAS发出的可以开启人机共驾的通知时，导航内显示人机共驾状态信息窗口（目前暂定简易导航下方显示）。其他情况下，隐藏此窗口的显示。\n3.3.1.2 引导中规划路线内可共驾路段开始及结束点显示\n引导过程中，在标清地图的路线内，以图标标注引导路线内可共驾路段的开始及结束点。\n3.3.2 导航内车辆引导线的显示\nADAS会将行驶的方向以多个点或指定方向的形式通知导航，导航需要将ADAS行驶的方向以引导线行驶描画在地图上。\n3.3.3 导航内ADAS识别物体的显示\n人机共驾导航内显示ADAS系统识别的物体及相应位置。\n物体的类型，需要与车机及ADAS确认。\n3.3.3.1 车辆的显示\n根据车辆类型，显示不同的3D车辆白膜，车辆类型包括（需要与车机及ADAS确认）：\n基本型乘用车（轿车）\n多用途车（MPV）\n运动型多用途车（SUV）\n专用乘用车\n交叉性乘用车（面包车）\n公交车\n运输车辆等。\n3.3.3.2 行人的显示（want）\n行人一般包括路上和路边行人，为方便渲染可以统一成固定人物模型。\n3.3.4 导航内人机共驾驾驶方向显示\n3.3.4.1 车道保持\n车道保持状态下，保持车道级导航地图显示的状态，人机共驾状态信息窗口保持显示人机共驾图标及文字“已开启人机共驾“。\n3.3.4.2 车辆变道\n车辆变道包含超越慢车、驶入匝道、汇入主路、向左/右变道、躲避障碍。\n具体的提示方法需根据ADAS系统接入的信息定义。\n1、 当ADAS进行向左/右变道、躲避障碍等操作，并提供相应的变道信息，在人机共驾状态信息窗口内显示变道方向及相应信息:”即将向左/右变道”，导航内显示变道路线，对即将进入的道路进行高亮显示。导航内显示如下图：\n2、 当ADAS进行向左/右变道超车，并提供相应的变道信息，在人机共驾状态信息窗口内显示变道方向及相应信息“即将向左/右超车“，并显示变道路线，对即将进入的道路进行高亮显示。导航内显示如下图：\n3、当ADAS因安全或附近车辆等问题，执行变道失败时，在人机共驾状态信息窗口内显示“变道失败”。\n3.3.4.3 3.3.4.3进入匝道/汇入主路\n在接近汇入匝道/汇入主路的路口，ADAS执行相应的变道。导航则在人机共驾状态信息窗口内显示变道方向及文字提示“即将驶入匝道/汇入主路“。\n3.3.4.4 路口左转/右转/掉头\n在接近左转/右转/掉头的路口，ADAS执行左转/右转/掉头。在人机共驾状态信息窗口内显示人机共驾驾驶方向及文字提示“左转/右转/掉头”。\n3.3.5 导航内人机共驾模式与标清导航的切换\n在导航界面内能够实现人机共驾模式与标清地图导航的切换。\n3.3.5.1 车道级导航切换至标清地图导航\n人机共驾导航状态下，点击：（左下角）\n导航由人机共驾模式切换至标清导航状态。\n3.3.5.2 标清地图导航切换至人机共驾模式\n当用户由人机共驾模式切换至标清地图时，且处于高清地图范围内，在导航内提供人机共驾模式切换按钮。在标清导航状态下，点击：\n导航由标清导航切换至人机共驾模式。\n3.4 人机共驾导航的警示信息\n人机共驾导航的警示信息包含碰撞预警、紧急制动、车道偏离、请保持手握方向盘、强制驾驶员接管的信息提示。\n目前判断，所有的警示弹窗（例如下图的“小心碰撞”弹窗），都是车机系统弹出的，不是导航弹出的，不需要导航处理。\n3.4.1 碰撞预警\n当ADAS传输碰撞信息,将即将碰撞的ADAS识别物体标红：\n3.4.2 车道偏离\n当ADAS传输车道偏离信息，同时标红偏离的车道线。\n3.4.3 强制驾驶员接管\n当ADAS传输强制驾驶员接管信息，导航需要显示ADAS相应的警告信息“请接管方向”。\n4. 依赖",
  "features": [
    {
      "id": 1,
      "name": "人机共驾路段显示",
      "description": "在算路画页中展示人机共驾路段信息，包括可开启距离及起始点图标标注，通过地理围栏判断可驾驶路段"
    },
    {
      "id": 2,
      "name": "人机共驾模式开启控制",
      "description": "根据ADAS信号显示人机共驾状态窗口，包含可开启/已开启状态提示及用户操作反馈"
    },
    {
      "id": 3,
      "name": "人机共驾模式退出管理",
      "description": "处理多种退出场景（正常/异常/Off Route/手动退出）并同步更新导航界面状态"
    },
    {
      "id": 4,
      "name": "车道级导航显示",
      "description": "全屏显示车道级导航地图，包含道路要素、车辆定位、导航引导信息及操作限制"
    },
    {
      "id": 5,
      "name": "ADAS物体识别显示",
      "description": "实时展示ADAS识别的车辆/行人等物体，支持不同车型的3D模型渲染"
    },
    {
      "id": 6,
      "name": "驾驶方向动态提示",
      "description": "通过状态窗口和地图高亮显示ADAS的变道、转向、汇入匝道等操作指令"
    },
    {
      "id": 7,
      "name": "导航模式切换功能",
      "description": "支持人机共驾模式与标清地图导航的双向切换及状态同步"
    },
    {
      "id": 8,
      "name": "导航状态警示提示",
      "description": "显示碰撞预警、车道偏离等ADAS警示信息（注：非导航系统主动弹窗）"
    },
    {
      "id": 9,
      "name": "用户主动结束导航",
      "description": "处理用户主动结束导航操作，包含退出人机共驾模式及导航回退逻辑"
    },
    {
      "id": 10,
      "name": "Unity 3D渲染支持",
      "description": "人机共驾模式下使用Unity 3D技术实现三维地图渲染及交互效果"
    }
  ],
  "test_points": {
    "0": [
      {
        "id": 1,
        "name": "USB离线地图升级异常处理",
        "type": "功能性",
        "priority": "高",
        "description": "当用户插入无效USB设备时，系统应正确识别并提示错误信息",
        "precondition": "USB设备已插入车机系统，且设备内无有效地图DB文件",
        "expected_result": "系统弹出错误提示'The USB Navigation Database is invalid. Please contact the after-sales team.'，并阻止升级操作"
      },
      {
        "id": 2,
        "name": "断点续传功能验证",
        "type": "性能",
        "priority": "高",
        "description": "验证离线地图下载过程中断后能否从断点继续下载",
        "precondition": "正在进行地图下载操作，突然断开网络连接",
        "expected_result": "系统自动保存下载进度，恢复网络后继续下载剩余数据，最终完成下载"
      },
      {
        "id": 3,
        "name": "多线程下载压力测试",
        "type": "性能",
        "priority": "中",
        "description": "测试同时下载多个地图数据包时的系统资源占用情况",
        "precondition": "用户同时发起5个地图区域的下载任务",
        "expected_result": "系统资源占用率在合理范围内（CPU<80%，内存<90%），下载任务正常进行且无数据丢失"
      },
      {
        "id": 4,
        "name": "离线地图删除级联验证",
        "type": "功能性",
        "priority": "高",
        "description": "验证删除父级地图数据时是否会自动删除子级数据",
        "precondition": "本地已下载包含子区域的地图数据包",
        "expected_result": "删除父级数据后，所有关联的子级数据包同步被删除，系统提示'地图数据已彻底删除'"
      },
      {
        "id": 5,
        "name": "跨平台兼容性测试",
        "type": "兼容性",
        "priority": "中",
        "description": "验证离线地图功能在不同操作系统版本下的兼容性",
        "precondition": "测试环境包含Android 10/12和iOS 14/16系统",
        "expected_result": "所有版本均能正常完成地图下载、更新和删除操作，无功能异常"
      }
    ]
  },
  "test_cases": {
    "0,4": [
      {
        "case_id": "TC001",
        "title": "Android 10系统离线地图下载兼容性测试",
        "priority": "中",
        "precondition": "设备已安装应用，系统版本为Android 10，网络连接正常",
        "test_steps": [
          {
            "step": 1,
            "action": "打开应用进入离线地图管理界面",
            "expected": "成功进入离线地图管理界面"
          },
          {
            "step": 2,
            "action": "点击'下载'按钮选择指定区域地图数据",
            "expected": "弹出下载确认对话框"
          },
          {
            "step": 3,
            "action": "确认下载操作并观察下载进度",
            "expected": "显示实时下载进度条，进度范围0-100%"
          },
          {
            "step": 4,
            "action": "主动暂停下载任务",
            "expected": "下载状态变为'暂停'，进度条停止更新"
          },
          {
            "step": 5,
            "action": "重新启动下载任务",
            "expected": "下载任务继续执行，进度条恢复更新"
          }
        ],
        "test_data": "指定区域地图数据（如欧洲地图）",
        "expected_result": "下载操作在Android 10系统上正常执行，支持断点续传",
        "postcondition": "删除测试用的下载任务"
      },
      {
        "case_id": "TC002",
        "title": "Android 12系统离线地图更新兼容性测试",
        "priority": "中",
        "precondition": "设备系统版本为Android 12，已下载基础地图数据，网络连接正常",
        "test_steps": [
          {
            "step": 1,
            "action": "进入离线地图管理界面，找到待更新地图数据",
            "expected": "显示待更新状态标识"
          },
          {
            "step": 2,
            "action": "点击'更新'按钮并选择更新策略（差分更新/部分更新）",
            "expected": "弹出更新策略选择对话框"
          },
          {
            "step": 3,
            "action": "确认更新操作并观察更新过程",
            "expected": "显示更新进度条，支持断点续传"
          },
          {
            "step": 4,
            "action": "主动取消更新任务",
            "expected": "更新状态变为'已取消'，数据保留可重试状态"
          },
          {
            "step": 5,
            "action": "重新尝试更新操作",
            "expected": "从上次中断处继续更新"
          }
        ],
        "test_data": "需要更新的区域地图数据（如日本地图）",
        "expected_result": "更新操作在Android 12系统上正常执行，支持多线程更新",
        "postcondition": "清理测试用的更新任务"
      },
      {
        "case_id": "TC003",
        "title": "iOS 14系统离线地图删除兼容性测试",
        "priority": "中",
        "precondition": "设备系统版本为iOS 14，已下载多个地图数据包，网络连接正常",
        "test_steps": [
          {
            "step": 1,
            "action": "进入离线地图管理界面，选择父级地图数据",
            "expected": "显示包含子级数据的列表"
          },
          {
            "step": 2,
            "action": "点击'删除'按钮并选择删除选项",
            "expected": "弹出删除确认对话框"
          },
          {
            "step": 3,
            "action": "确认删除操作并观察删除过程",
            "expected": "显示删除进度条，删除完成后更新列表"
          },
          {
            "step": 4,
            "action": "尝试删除预装地图数据",
            "expected": "提示'预装数据不可删除'并显示错误提示"
          },
          {
            "step": 5,
            "action": "检查删除后数据存储空间",
            "expected": "存储空间释放量与删除数据量一致"
          }
        ],
        "test_data": "包含子级数据的父级地图数据（如中国地图）",
        "expected_result": "删除操作在iOS 14系统上正常执行，支持级联删除",
        "postcondition": "恢复测试用的删除数据"
      },
      {
        "case_id": "TC004",
        "title": "iOS 16系统离线地图USB升级兼容性测试",
        "priority": "中",
        "precondition": "设备系统版本为iOS 16，插入包含有效地图DB的USB设备",
        "test_steps": [
          {
            "step": 1,
            "action": "插入USB设备并观察系统提示",
            "expected": "显示'The USB Navigation Database is valid'提示"
          },
          {
            "step": 2,
            "action": "点击'开始升级'按钮并选择升级模式（全量/指定区域）",
            "expected": "弹出升级模式选择对话框"
          },
          {
            "step": 3,
            "action": "确认升级操作并观察升级过程",
            "expected": "显示实时升级进度条，进度范围0-100%"
          },
          {
            "step": 4,
            "action": "主动暂停升级任务",
            "expected": "升级状态变为'暂停'，进度条停止更新"
          },
          {
            "step": 5,
            "action": "模拟网络中断并检查系统提示",
            "expected": "显示'Network connection error, map update failed.'提示"
          }
        ],
        "test_data": "包含不同版本地图DB的USB设备",
        "expected_result": "USB升级在iOS 16系统上正常执行，支持断点续传",
        "postcondition": "移除USB设备并清理测试数据"
      },
      {
        "case_id": "TC005",
        "title": "跨平台空间不足异常处理测试",
        "priority": "中",
        "precondition": "设备系统版本为Android 10/iOS 14，存储空间不足",
        "test_steps": [
          {
            "step": 1,
            "action": "尝试下载需要大容量的地图数据",
            "expected": "显示'Not enough space, map download failed.'提示"
          },
          {
            "step": 2,
            "action": "尝试更新需要大容量的地图数据",
            "expected": "显示'Not enough space,Need space:XXMB'提示"
          },
          {
            "step": 3,
            "action": "清理部分存储空间后重新尝试操作",
            "expected": "操作成功执行，存储空间释放量与清理量一致"
          }
        ],
        "test_data": "需要大容量的地图数据（如全球地图）",
        "expected_result": "系统在跨平台环境下正确处理存储空间不足异常",
        "postcondition": "恢复原始存储空间状态"
      },
      {
        "case_id": "TC006",
        "title": "跨平台网络中断异常处理测试",
        "priority": "中",
        "precondition": "设备系统版本为Android 12/iOS 16，网络连接正常",
        "test_steps": [
          {
            "step": 1,
            "action": "开始下载地图数据并主动断开网络",
            "expected": "显示'Network connection error, map download failed.'提示"
          },
          {
            "step": 2,
            "action": "尝试更新地图数据并主动断开网络",
            "expected": "显示'Network connection error, map update failed.'提示"
          },
          {
            "step": 3,
            "action": "重新连接网络后尝试重试操作",
            "expected": "操作从中断点继续执行，进度条恢复更新"
          }
        ],
        "test_data": "需要网络连接的地图数据",
        "expected_result": "系统在跨平台环境下正确处理网络中断异常",
        "postcondition": "清理测试用的网络操作数据"
      }
    ]
  }
}